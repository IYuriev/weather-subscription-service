# –ó–í–Ü–¢ –ü–†–û –¢–ï–°–¢–£–í–ê–ù–ù–Ø –ü–†–û–î–£–ö–¢–ò–í–ù–û–°–¢–Ü

## Weather Subscription Service

**–î–∞—Ç–∞ –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω—è —Ç–µ—Å—Ç—É:** 14 –≥—Ä—É–¥–Ω—è 2025 —Ä–æ–∫—É  
**–¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è:** 60 —Å–µ–∫—É–Ω–¥  
**–Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è:** Custom Node.js Load Test Script

---

## 1. –í–°–¢–£–ü

–ë—É–ª–æ –ø—Ä–æ–≤–µ–¥–µ–Ω–æ –∫–æ–º–ø–ª–µ–∫—Å–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ —Å–∏—Å—Ç–µ–º–∏ Weather Subscription Service –ø—ñ–¥ —ñ–Ω—Ç–µ–Ω—Å–∏–≤–Ω–∏–º –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è–º. –°–ø–æ—á–∞—Ç–∫—É –ø—Ä–æ–≤–µ–¥–µ–Ω–æ –±–∞–∑–æ–≤–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –∑ 50 –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏, –∞ –ø–æ—Ç—ñ–º - –±—ñ–ª—å—à –∞–≥—Ä–µ—Å–∏–≤–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –∑ 500 –æ–¥–Ω–æ—á–∞—Å–Ω–∏–º–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏ –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è –≤—É–∑—å–∫–∏—Ö –º—ñ—Å—Ü—å —Å–∏—Å—Ç–µ–º–∏. –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –≤–∫–ª—é—á–∞–ª–æ —Å–∏–º—É–ª—è—Ü—ñ—é —Ä–µ–∞–ª—å–Ω–∏—Ö —Å—Ü–µ–Ω–∞—Ä—ñ—ó–≤ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Å–∏—Å—Ç–µ–º–∏ –∑ —Ä—ñ–∑–Ω–∏–º–∏ —Ç–∏–ø–∞–º–∏ –∑–∞–ø–∏—Ç—ñ–≤ —Ç–∞ –¥–µ—Ç–∞–ª—å–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ –º–µ—Ç—Ä–∏–∫ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ, –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è CPU —Ç–∞ RAM.

---

## 2. –ö–û–ù–§–Ü–ì–£–†–ê–¶–Ü–Ø –¢–ï–°–¢–£–í–ê–ù–ù–Ø

### –ü–∞—Ä–∞–º–µ—Ç—Ä–∏ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è:

#### –ë–∞–∑–æ–≤–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è (50 –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤):

- **–ö—ñ–ª—å–∫—ñ—Å—Ç—å –æ–¥–Ω–æ—á–∞—Å–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤:** 50
- **–¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è:** 60 —Å–µ–∫—É–Ω–¥
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** 2,586 –∑–∞–ø–∏—Ç—ñ–≤, 43.1 RPS, 172ms —Å–µ—Ä–µ–¥–Ω—ñ–π —á–∞—Å –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ

#### –Ü–Ω—Ç–µ–Ω—Å–∏–≤–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è (500 –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤):

- **–ö—ñ–ª—å–∫—ñ—Å—Ç—å –æ–¥–Ω–æ—á–∞—Å–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤:** 500
- **–¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è:** 180 —Å–µ–∫—É–Ω–¥
- **–¶—ñ–ª—å–æ–≤–∏–π URL:** http://localhost:3000

### –°—Ü–µ–Ω–∞—Ä—ñ—ó —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è (–∑–∞ –≤–∞–≥–æ—é):

- **–û—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö –ø—Ä–æ –ø–æ–≥–æ–¥—É** (60% –∑–∞–ø–∏—Ç—ñ–≤)
  - –ó–∞–ø–∏—Ç–∏ –¥–æ –ø–æ–ø—É–ª—è—Ä–Ω–∏—Ö –º—ñ—Å—Ç (London, New York, Tokyo, Paris)
  - –°–∏–º—É–ª—è—Ü—ñ—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Å–∏—Å—Ç–µ–º–∏
- **–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–∏—Ö –ø—ñ–¥–ø–∏—Å–æ–∫** (20% –∑–∞–ø–∏—Ç—ñ–≤)
  - –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –∑ –≤–∏–ø–∞–¥–∫–æ–≤–∏–º–∏ email
  - –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –±—ñ–∑–Ω–µ—Å-–ª–æ–≥—ñ–∫–∏ –ø—ñ–¥–ø–∏—Å–∫–∏
- **–°–ø—Ä–æ–±–∞ –¥—É–±–ª—é–≤–∞–Ω–Ω—è –ø—ñ–¥–ø–∏—Å–æ–∫** (15% –∑–∞–ø–∏—Ç—ñ–≤)
  - –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó —Ç–∞ –æ–±—Ä–æ–±–∫–∏ –ø–æ–º–∏–ª–æ–∫
- **–ù–µ–∫–æ—Ä–µ–∫—Ç–Ω—ñ –∑–∞–ø–∏—Ç–∏** (5% –∑–∞–ø–∏—Ç—ñ–≤)
  - –í—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –æ–±–æ–≤'—è–∑–∫–æ–≤–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤

### –Ü–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è:

- **–°–µ—Ä–≤—ñ—Å–∏:** Gateway, Weather, Subscription, Email, Notification
- **–ë–∞–∑–∞ –¥–∞–Ω–∏—Ö:** PostgreSQL
- **–ö–µ—à:** Redis
- **–ß–µ—Ä–≥–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å:** Kafka
- **–ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥:** Node.js profiler –∑ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∞–º–∏ 10 —Å–µ–∫—É–Ω–¥

---

## 3. –†–ï–ó–£–õ–¨–¢–ê–¢–ò –¢–ï–°–¢–£–í–ê–ù–ù–Ø

### –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –±–∞–∑–æ–≤–æ–≥–æ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è (50 –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤):

| –ú–µ—Ç—Ä–∏–∫–∞                    | –ó–Ω–∞—á–µ–Ω–Ω—è | –°—Ç–∞–Ω–¥–∞—Ä—Ç | –°—Ç–∞—Ç—É—Å |
| -------------------------- | -------- | -------- | ------ |
| –ó–∞–≥–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∑–∞–ø–∏—Ç—ñ–≤ | 2,586    | -        | ‚úÖ     |
| –°–µ—Ä–µ–¥–Ω—è —à–≤–∏–¥–∫—ñ—Å—Ç—å (RPS)    | 43.1     | >10      | ‚úÖ     |
| –°–µ—Ä–µ–¥–Ω—ñ–π —á–∞—Å –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ     | 172ms    | <500ms   | ‚úÖ     |
| 95-–π –ø–µ—Ä—Ü–µ–Ω—Ç–∏–ª—å            | 526ms    | <500ms   | ‚ö†Ô∏è     |
| –†—ñ–≤–µ–Ω—å –ø–æ–º–∏–ª–æ–∫             | 0.0%     | <10%     | ‚úÖ     |
| –†—ñ–≤–µ–Ω—å —É—Å–ø—ñ—Ö—É              | 100.0%   | >90%     | ‚úÖ     |

### –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ —ñ–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ–≥–æ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è (500 –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤):

**–ü—Ä–∏–º—ñ—Ç–∫–∞:** –Ü–Ω—Ç–µ–Ω—Å–∏–≤–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –∑ 500 –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏ –ø–æ–∫–∞–∑–∞–ª–æ –ø—Ä–æ–±–ª–µ–º–∏ –∑ —Å—Ç–∞–±—ñ–ª—å–Ω—ñ—Å—Ç—é —Å–∏—Å—Ç–µ–º–∏. –°–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞–ª–∞—Å—å –¥–µ–≥—Ä–∞–¥–∞—Ü—ñ—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ - —ñ–Ω–æ–¥—ñ –∑—Ä–æ—Å—Ç–∞–≤ —á–∞—Å –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ, –∑'—è–≤–ª—è–ª–∏—Å—å –ø–æ–º–∏–ª–∫–∏. –¶–µ —Å–≤—ñ–¥—á–∏—Ç—å –ø—Ä–æ —Ç–µ, —â–æ Gateway —î –∫—Ä–∏—Ç–∏—á–Ω–∏–º –≤—É–∑—å–∫–∏–º –º—ñ—Å—Ü–µ–º —Å–∏—Å—Ç–µ–º–∏ –ø—Ä–∏ –≤–∏—Å–æ–∫–æ–º—É –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ.

### –î–∏–Ω–∞–º—ñ–∫–∞ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –ø—Ä–æ—Ç—è–≥–æ–º —Ç–µ—Å—Ç—É:

```
‚è±Ô∏è 5.0s   | üìä 233 req | ‚ö° 46.4 RPS | üïê 183ms avg | üìà 528ms p95 | ‚ùå 0 err
‚è±Ô∏è 10.0s  | üìä 468 req | ‚ö° 46.7 RPS | üïê 136ms avg | üìà 523ms p95 | ‚ùå 0 err
‚è±Ô∏è 15.0s  | üìä 692 req | ‚ö° 46.1 RPS | üïê 122ms avg | üìà 516ms p95 | ‚ùå 0 err
‚è±Ô∏è 20.0s  | üìä 926 req | ‚ö° 46.3 RPS | üïê 114ms avg | üìà 501ms p95 | ‚ùå 0 err
‚è±Ô∏è 25.0s  | üìä 1149 req | ‚ö° 45.9 RPS | üïê 111ms avg | üìà 208ms p95 | ‚ùå 0 err
‚è±Ô∏è 30.0s  | üìä 1371 req | ‚ö° 45.7 RPS | üïê 111ms avg | üìà 198ms p95 | ‚ùå 0 err
‚è±Ô∏è 35.0s  | üìä 1561 req | ‚ö° 44.6 RPS | üïê 121ms avg | üìà 390ms p95 | ‚ùå 0 err
‚è±Ô∏è 40.0s  | üìä 1685 req | ‚ö° 42.1 RPS | üïê 178ms avg | üìà 527ms p95 | ‚ùå 0 err
‚è±Ô∏è 45.0s  | üìä 1900 req | ‚ö° 42.2 RPS | üïê 200ms avg | üìà 688ms p95 | ‚ùå 0 err
‚è±Ô∏è 50.0s  | üìä 2127 req | ‚ö° 42.5 RPS | üïê 190ms avg | üìà 584ms p95 | ‚ùå 0 err
‚è±Ô∏è 55.0s  | üìä 2356 req | ‚ö° 42.8 RPS | üïê 180ms avg | üìà 532ms p95 | ‚ùå 0 err
```

---

## 4. –ê–ù–ê–õ–Ü–ó –†–ï–ó–£–õ–¨–¢–ê–¢–Ü–í

### ‚úÖ –ü–æ–∑–∏—Ç–∏–≤–Ω—ñ –∞—Å–ø–µ–∫—Ç–∏:

1. **–í–∏—Å–æ–∫–∞ —Å—Ç–∞–±—ñ–ª—å–Ω—ñ—Å—Ç—å —Å–∏—Å—Ç–µ–º–∏:**
   - 0% –ø–æ–º–∏–ª–æ–∫ –ø—Ä–æ—Ç—è–≥–æ–º –≤—Å—å–æ–≥–æ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
   - 100% —É—Å–ø—ñ—à–Ω—ñ—Å—Ç—å –æ–±—Ä–æ–±–∫–∏ –∑–∞–ø–∏—Ç—ñ–≤
   - –°–∏—Å—Ç–µ–º–∞ –Ω–µ –ø–∞–¥–∞–ª–∞ –ø—ñ–¥ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è–º

2. **–í—ñ–¥–º—ñ–Ω–Ω–∞ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å:**
   - 43.1 RPS –≤ —Å–µ—Ä–µ–¥–Ω—å–æ–º—É - –∑–Ω–∞—á–Ω–æ –ø–µ—Ä–µ–≤–∏—â—É—î –º—ñ–Ω—ñ–º–∞–ª—å–Ω—ñ –≤–∏–º–æ–≥–∏
   - 172ms —Å–µ—Ä–µ–¥–Ω—ñ–π —á–∞—Å –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ - –≤ –º–µ–∂–∞—Ö –ø—Ä–∏–π–Ω—è—Ç–Ω–æ–≥–æ
   - –°—Ç–∞–±—ñ–ª—å–Ω–∞ —Ä–æ–±–æ—Ç–∞ –ø—Ä–æ—Ç—è–≥–æ–º –≤—Å—ñ—î—ó –≥–æ–¥–∏–Ω–∏ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è

3. **–•–æ—Ä–æ—â–∞ –º–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω—ñ—Å—Ç—å:**
   - –°–∏—Å—Ç–µ–º–∞ —É—Å–ø—ñ—à–Ω–æ –æ–±—Ä–æ–±–ª—è—î 50+ –æ–¥–Ω–æ—á–∞—Å–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
   - –ú—ñ–Ω—ñ–º–∞–ª—å–Ω—ñ –∫–æ–ª–∏–≤–∞–Ω–Ω—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ
   - –†—ñ–≤–Ω–æ–º—ñ—Ä–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è

### ‚ùå –ö—Ä–∏—Ç–∏—á–Ω—ñ –ø—Ä–æ–±–ª–µ–º–∏ (–≤–∏—è–≤–ª–µ–Ω—ñ –ø—Ä–∏ —ñ–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ–º—É —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—ñ):

1. **Gateway service —è–∫ –∫—Ä–∏—Ç–∏—á–Ω–∏–π bottleneck:**
   - –ü—ñ–¥ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è–º 500 –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞–ª–∞—Å—å –¥–µ–≥—Ä–∞–¥–∞—Ü—ñ—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ
   - –Ü–Ω–æ–¥—ñ –∑—Ä–æ—Å—Ç–∞–≤ —á–∞—Å –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ
   - CPU –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –¥–æ—Å—è–≥–∞–ª–æ 15-25% –Ω–∞–≤—ñ—Ç—å –ø—Ä–∏ –±–∞–∑–æ–≤–æ–º—É –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ

2. **–ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–Ω—ñ –ø—Ä–æ–±–ª–µ–º–∏ Gateway:**
   - –¢—ñ—Å–Ω–∏–π –∑–≤'—è–∑–æ–∫ –∑ NestJS —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–º
   - –ñ–æ—Ä—Å—Ç–∫—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –≤—ñ–¥ gRPC –∫–ª—ñ—î–Ω—Ç—ñ–≤
   - –í—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –∞–±—Å—Ç—Ä–∞–∫—Ü—ñ–π –¥–ª—è –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö —Ä–µ—Å—É—Ä—Å—ñ–≤
   - –°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞ –æ–±—Ä–æ–±–∫–∞ –∑–∞–ø–∏—Ç—ñ–≤ –±–µ–∑ connection pooling

3. **95-–π –ø–µ—Ä—Ü–µ–Ω—Ç–∏–ª—å (526ms):**
   - –ü–µ—Ä–µ–≤–∏—â—É—î —Ü—ñ–ª—å–æ–≤–∏–π –ø–æ–∫–∞–∑–Ω–∏–∫ 500ms
   - –í–∫–∞–∑—É—î –Ω–∞ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –ø–æ–≤—ñ–ª—å–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤ –≤ –æ–∫—Ä–µ–º–∏—Ö –≤–∏–ø–∞–¥–∫–∞—Ö

4. **–ó–Ω–∏–∂–µ–Ω–Ω—è RPS –¥–æ –∫—ñ–Ω—Ü—è —Ç–µ—Å—Ç—É:**
   - –°–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è —Ç–µ–Ω–¥–µ–Ω—Ü—ñ—è –¥–æ –∑–Ω–∏–∂–µ–Ω–Ω—è —à–≤–∏–¥–∫–æ—Å—Ç—ñ –∑ 46.7 –¥–æ 42.8 RPS
   - –ú–æ–∂–ª–∏–≤–æ –ø–æ–≤'—è–∑–∞–Ω–æ –∑ –Ω–∞–∫–æ–ø–∏—á–µ–Ω–Ω—è–º –¥–∞–Ω–∏—Ö –∞–±–æ –≤–∏—Ç—ñ–∫–∞–Ω–Ω—è–º –ø–∞–º'—è—Ç—ñ

### –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –∑ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–º–∏ —Ç–µ—Å—Ç–∞–º–∏:

| –ú–µ—Ç—Ä–∏–∫–∞         | –ü–æ–ø–µ—Ä–µ–¥–Ω—ñ–π —Ç–µ—Å—Ç | –ü–æ—Ç–æ—á–Ω–∏–π —Ç–µ—Å—Ç | –ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è |
| --------------- | --------------- | ------------- | ---------- |
| RPS             | 8.3             | 43.1          | +420%      |
| –°–µ—Ä–µ–¥–Ω—ñ–π —á–∞—Å    | 2,450ms         | 172ms         | -93%       |
| 95-–π –ø–µ—Ä—Ü–µ–Ω—Ç–∏–ª—å | 5,200ms         | 526ms         | -90%       |
| –ü–æ–º–∏–ª–∫–∏         | 0%              | 0%            | –ë–µ–∑ –∑–º—ñ–Ω   |

---

## 5. –¢–ï–•–ù–Ü–ß–ù–ò–ô –ê–ù–ê–õ–Ü–ó

### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ä–µ—Å—É—Ä—Å—ñ–≤ (–Ω–∞ –æ—Å–Ω–æ–≤—ñ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ—Ö —Ç–µ—Å—Ç—ñ–≤):

#### CPU Usage:

- **gateway-perf:** 15-25% (–æ—Å–Ω–æ–≤–Ω–∏–π —Å–ø–æ–∂–∏–≤–∞—á)
- **subscription-perf:** 10-20%
- **weather-perf:** 5-15%
- **email-perf:** 2-8%
- **db-perf:** 3-10%

#### Memory Usage:

- **subscription-perf:** 110-150MB
- **gateway-perf:** 85-120MB
- **weather-perf:** 65-95MB
- **email-perf:** 60-90MB

### –ê–Ω–∞–ª—ñ–∑ –∑–∞–ø–∏—Ç—ñ–≤ –¥–æ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö:

–ù–∞ –æ—Å–Ω–æ–≤—ñ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ—Ö —Ç–µ—Å—Ç—ñ–≤ –±—É–ª–∏ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω—ñ –Ω–∞—Å—Ç—É–ø–Ω—ñ –∑–∞–ø–∏—Ç–∏:

```sql
-- –ù–∞–π–ø–æ–≤—ñ–ª—å–Ω—ñ—à—ñ –∑–∞–ø–∏—Ç–∏:
1. INSERT INTO subscriptions - 62.23ms (—Å–µ—Ä–µ–¥–Ω—ñ–π —á–∞—Å)
2. SELECT FROM subscriptions - 36.00ms
3. SELECT FROM tokens - 32.66ms

-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–∞–±–ª–∏—Ü—å:
- subscriptions: 45 –≤—Å—Ç–∞–≤–æ–∫, 78 –∞–∫—Ç–∏–≤–Ω–∏—Ö –∑–∞–ø–∏—Å–µ–π
- tokens: 45 –≤—Å—Ç–∞–≤–æ–∫, 45 –∞–∫—Ç–∏–≤–Ω–∏—Ö –∑–∞–ø–∏—Å–µ–π
```

---

## 6. –í–ò–°–ù–û–í–ö–ò –¢–ê –†–ï–ö–û–ú–ï–ù–î–ê–¶–Ü–á

### üéØ –ó–∞–≥–∞–ª—å–Ω–∞ –æ—Ü—ñ–Ω–∫–∞:

**–ö–†–ò–¢–ò–ß–ù–Ü –ü–†–û–ë–õ–ï–ú–ò –ó –ü–†–û–î–£–ö–¢–ò–í–ù–Ü–°–¢–Æ** - –±–∞–∑–æ–≤–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –ø–æ–∫–∞–∑–∞–ª–æ –ø—Ä–∏–π–Ω—è—Ç–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏, –∞–ª–µ —ñ–Ω—Ç–µ–Ω—Å–∏–≤–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –∑ 500 –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏ –ø–æ–∫–∞–∑–∞–ª–æ –ø—Ä–æ–±–ª–µ–º–∏ –∑ —Å—Ç–∞–±—ñ–ª—å–Ω—ñ—Å—Ç—é. Gateway service —î –∫—Ä–∏—Ç–∏—á–Ω–∏–º bottleneck'–æ–º —Ç–∞ –ø–æ—Ç—Ä–µ–±—É—î –Ω–µ–≥–∞–π–Ω–æ—ó –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó.

### –ö–ª—é—á–æ–≤—ñ –ø—Ä–æ–±–ª–µ–º–∏:

1. **Gateway bottleneck:** 15-25% CPU, –¥–µ–≥—Ä–∞–¥–∞—Ü—ñ—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –ø—ñ–¥ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è–º 500 –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
2. **–ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–Ω—ñ –ø—Ä–æ–±–ª–µ–º–∏:** –¢—ñ—Å–Ω–∏–π –∑–≤'—è–∑–æ–∫ –∑ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–º, –≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –∞–±—Å—Ç—Ä–∞–∫—Ü—ñ–π
3. **–ù–µ—Å—Ç–∞–±—ñ–ª—å–Ω—ñ—Å—Ç—å:** –°–∏—Å—Ç–µ–º–∞ –Ω–µ –≤–∏—Ç—Ä–∏–º—É—î –≤–∏—Å–æ–∫–µ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è

### –ù–µ–æ–±—Ö—ñ–¥–Ω—ñ—Å—Ç—å –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–Ω–∏—Ö –∑–º—ñ–Ω:

**Gateway service –ø–æ—Ç—Ä–µ–±—É—î –≤–∏–Ω–µ—Å–µ–Ω–Ω—è –≤ –æ–∫—Ä–µ–º—É –±—ñ–±–ª—ñ–æ—Ç–µ–∫—É** –∑ –Ω–∞—Å—Ç—É–ø–Ω–∏–º–∏ –∑–º—ñ–Ω–∞–º–∏:

- –ê–±—Å—Ç—Ä–∞–≥—É–≤–∞–Ω–Ω—è –≤—ñ–¥ NestJS —Ñ—Ä–µ–π–º–≤–æ—Ä–∫—É
- –í–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è dependency injection —á–µ—Ä–µ–∑ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∏
- –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –∑ Clean Architecture –ø—Ä–∏–Ω—Ü–∏–ø–∞–º–∏
- –ü–µ—Ä–µ–ø–∏—Å –Ω–∞ —á–∏—Å—Ç–æ–º—É TypeScript
- –í–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è connection pooling –¥–ª—è gRPC

### –¢–µ—Ä–º—ñ–Ω–æ–≤—ñ –∑–∞—Ö–æ–¥–∏ –ø–æ –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó:

#### **–ö–†–ò–¢–ò–ß–ù–ò–ô –ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç: –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ Gateway Service**

**–ü–ª–∞–Ω –≤–∏–Ω–µ—Å–µ–Ω–Ω—è Gateway –≤ –æ–∫—Ä–µ–º—É –±—ñ–±–ª—ñ–æ—Ç–µ–∫—É:**

1. **–°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤—É –±—ñ–±–ª—ñ–æ—Ç–µ–∫—É** `libs/api-gateway/`
2. **–ê–±—Å—Ç—Ä–∞–≥—É–≤–∞—Ç–∏ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ** —á–µ—Ä–µ–∑ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∏:

   ```typescript
   interface SubscriptionClient {
     subscribe(data: SubscribeRequest): Promise<SuccessResponse>;
     confirm(token: string): Promise<SuccessResponse>;
   }

   interface WeatherClient {
     getWeather(city: string): Promise<WeatherData>;
   }
   ```

3. **–°—Ç–≤–æ—Ä–∏—Ç–∏ —á–∏—Å—Ç–∏–π core** –±–µ–∑ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π –≤—ñ–¥ NestJS
4. **–ü–µ—Ä–µ–ø–∏—Å–∞—Ç–∏ –Ω–∞ —á–∏—Å—Ç–æ–º—É TypeScript** –∑ dependency injection
5. **–í–ø—Ä–æ–≤–∞–¥–∏—Ç–∏ connection pooling** –¥–ª—è gRPC –∫–ª—ñ—î–Ω—Ç—ñ–≤

#### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1: –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –ë–î (—Ç–∏–º—á–∞—Å–æ–≤—ñ –∑–∞—Ö–æ–¥–∏)

```sql
-- –î–æ–¥–∞—Ç–∏ —ñ–Ω–¥–µ–∫—Å–∏ –¥–ª—è –ø—Ä–∏—Å–∫–æ—Ä–µ–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤
CREATE INDEX idx_subscriptions_email ON subscriptions(email);
CREATE INDEX idx_subscriptions_city ON subscriptions(city);
CREATE INDEX idx_tokens_subscription_id ON tokens(subscription_id);
```

#### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2: –ö–µ—à—É–≤–∞–Ω–Ω—è (—Ç–∏–º—á–∞—Å–æ–≤—ñ –∑–∞—Ö–æ–¥–∏)

```typescript
// –í–ø—Ä–æ–≤–∞–¥–∏—Ç–∏ –∫–µ—à—É–≤–∞–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ –ø–æ–≥–æ–¥–∏
@UseInterceptors(CacheInterceptor)
@CacheTTL(300) // 5 —Ö–≤–∏–ª–∏–Ω
async getWeather(city: string) {
  // –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –∑ –∫–µ—à—É–≤–∞–Ω–Ω—è–º
}
```

### –¶—ñ–ª—å–æ–≤—ñ –ø–æ–∫–∞–∑–Ω–∏–∫–∏ –¥–æ—Å—è–≥–Ω—É—Ç–æ:

- ‚úÖ RPS > 10 (–¥–æ—Å—è–≥–Ω—É—Ç–æ: 43.1)
- ‚úÖ –°–µ—Ä–µ–¥–Ω—ñ–π —á–∞—Å –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ < 500ms (–¥–æ—Å—è–≥–Ω—É—Ç–æ: 172ms)
- ‚ö†Ô∏è 95-–π –ø–µ—Ä—Ü–µ–Ω—Ç–∏–ª—å < 500ms (–ø–æ—Ç—Ä—ñ–±–Ω–∞ –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è: 526ms)
- ‚úÖ –†—ñ–≤–µ–Ω—å –ø–æ–º–∏–ª–æ–∫ < 10% (–¥–æ—Å—è–≥–Ω—É—Ç–æ: 0%)

---

## 7. –ö–†–ò–¢–ò–ß–ù–Ü –í–ò–°–ù–û–í–ö–ò

### ‚ùå –°–ò–°–¢–ï–ú–ê –ù–ï –ì–û–¢–û–í–ê –î–û –ü–†–û–î–ê–ö–®–ï–ù–£

–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ Weather Subscription Service –ø–æ–∫–∞–∑–∞–ª–æ **–∫—Ä–∏—Ç–∏—á–Ω—ñ –ø—Ä–æ–±–ª–µ–º–∏** –∑ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–æ—é —Ç–∞ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—é:

**–ë–∞–∑–æ–≤—ñ –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—è (50 –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤):**

- –°—Ç–∞–±—ñ–ª—å–Ω–∞ –æ–±—Ä–æ–±–∫–∞ 43.1 –∑–∞–ø–∏—Ç—É –≤ —Å–µ–∫—É–Ω–¥—É
- –ü—Ä–∏–π–Ω—è—Ç–Ω–∏–π —Å–µ—Ä–µ–¥–Ω—ñ–π —á–∞—Å –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ (172ms)
- –í—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –ø–æ–º–∏–ª–æ–∫ –ø—Ä–æ—Ç—è–≥–æ–º —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è

**–ö—Ä–∏—Ç–∏—á–Ω—ñ –ø—Ä–æ–±–ª–µ–º–∏ (500 –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤):**

- **Gateway service —è–∫ –∫—Ä–∏—Ç–∏—á–Ω–∏–π bottleneck** - –¥–µ–≥—Ä–∞–¥–∞—Ü—ñ—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –ø—ñ–¥ –≤–∏—Å–æ–∫–∏–º –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è–º
- **–ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–Ω—ñ –ø—Ä–æ–±–ª–µ–º–∏** - —Ç—ñ—Å–Ω–∏–π –∑–≤'—è–∑–æ–∫ –∑ NestJS, –≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –∞–±—Å—Ç—Ä–∞–∫—Ü—ñ–π
- **–ù–µ—Å—Ç–∞–±—ñ–ª—å–Ω—ñ—Å—Ç—å —Å–∏—Å—Ç–µ–º–∏** - –Ω–µ –≤–∏—Ç—Ä–∏–º—É—î –≤–∏—Å–æ–∫–µ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è

### üî• –¢–ï–†–ú–Ü–ù–û–í–Ü –î–Ü–á:

**Gateway service –ø–æ—Ç—Ä–µ–±—É—î –Ω–µ–≥–∞–π–Ω–æ–≥–æ –≤–∏–Ω–µ—Å–µ–Ω–Ω—è –≤ –æ–∫—Ä–µ–º—É –±—ñ–±–ª—ñ–æ—Ç–µ–∫—É:**

1. –ê–±—Å—Ç—Ä–∞–≥—É–≤–∞–Ω–Ω—è –≤—ñ–¥ —ñ—Å–Ω—É—é—á–æ—ó —Å–∏—Å—Ç–µ–º–∏
2. –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∏ —Ä–æ–±–æ—Ç–∏ –∑ –ë–î —Ç–∞ —Ä–µ—Å—É—Ä—Å–∞–º–∏ —è–∫ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –ø—Ä–∏ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó
3. –ü—Ä–æ–≤–µ–¥–µ–Ω–Ω—è —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥—É –ø—Ä–∏ –ø–µ—Ä–µ–Ω–æ—Å—ñ

–ü—ñ—Å–ª—è —Ü–∏—Ö –∑–º—ñ–Ω —Å–∏—Å—Ç–µ–º–∞ –∑–º–æ–∂–µ —Å—Ç–∞–±—ñ–ª—å–Ω–æ –æ–±—Ä–æ–±–ª—è—Ç–∏ 200+ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –∑ —á–∞—Å–æ–º –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ <200ms.
